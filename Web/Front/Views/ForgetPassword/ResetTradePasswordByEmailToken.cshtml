@using DotPay.Language
<div class="fail box" id="failBox" style="display:none;">
    <img src="~/public/images/error.png" alt="Error!" class="left 2x" width="32"><strong>@Html.Lang("msg_box_error")!</strong><br><span id="spanFailBox"></span>
</div>
<div class="success box" id="sucessBox" style="display:none;">
    <img src="~/public/images/success.png" alt="Success!" class="left 2x" width="32"><strong>@Html.Lang("msg_box_success")!</strong><br><span id="spanSuccessBox"></span>
</div>
@if (ViewBag.Code == 1)
{
    <h1>@Html.Lang("Reset Trade Password")</h1>
    @Html.Lang("Please enter a new password.")
    <form id="registerForm" novalidate="novalidate">
        @Html.AntiForgeryToken()
        <input type="hidden" name="token" value="@ViewData["emailToken"]">
        <input type="hidden" name="userID" value="@ViewData["resetUserID"]">
        <br>
        <table class="table register">
            <tbody>
                <tr>
                    <th>@Html.Lang("Trade Password")</th>
                    <td>
                        <input type="password" name="password" id="password" value=""><br>
                        <span>@Html.Lang("Please enter 6 characters minimum, including 1 or more digits.")</span>
                    </td>
                </tr>
                <tr>
                    <th>Confirm Trade Password</th>
                    <td>
                        <input type="password" name="confirmpassword" id="confirmpassword" value=""><br>
                        <span>@Html.Lang("Please type your password again.")</span>
                    </td>
                </tr>

            </tbody>
        </table>

        <br>
        <input type="submit" value="@Html.Lang("Reset Trade Password")">
    ></form>
}
else
{
    <h1>@ViewBag.ErrorMessage</h1>
}
<script src="~/public/js/jquery.validate.min.js"></script>
<script type="text/javascript">
    $(document).ready(function () {

        $("#registerForm").validate({
            rules: {
                password: {
                    required: true,
                    minlength: 6
                },
                confirmpassword: {
                    required: true,
                    minlength: 6,
                    equalTo: "#password"
                }
            },
            messages: {
                password: {
                    required:  "@Html.Lang("Please provide a password")",
                    minlength: "@Html.Lang("Your password must be at least 6 characters long")"
                },
                confirmpassword: {
                    required:  "@Html.Lang("Please provide a password")",
                    minlength: "@Html.Lang("Your password must be at least 6 characters long")",
                    equalTo:  "@Html.Lang("Please enter the same password as above")"
            }
        }
        });


    $("#registerForm").submit(function (event) {
        event.preventDefault();
        if ($(this).valid()) {
            $.ajax({
                type: 'POST',
                url: '/resetTradePassword',
                data: $(this).serialize(),
                success: function (data) { 
                    commonFormCallback(data);
                }
            });
        }
    });
    });
</script>
